# Testing Básico de Performance con Artillery

## Introducción

Artillery es una herramienta de código abierto para simular carga y probar el rendimiento y la estabilidad de servidores bajo condiciones de tráfico real. Permite detectar cuellos de botella, latencias elevadas y posibles puntos de falla antes de producción.

## ¿Qué es Artillery?

Artillery simula usuarios concurrentes enviando peticiones (GET, POST, etc.) a uno o varios endpoints. Es útil para:

- Medir tiempos de respuesta.
- Evaluar escalabilidad.
- Validar estabilidad bajo carga sostenida o picos.

## Configuración básica

### Instalación

```bash
npm install -g artillery
```

### Archivo de configuración (YAML de ejemplo)

```yaml
config:
    target: "https://api.ejemplo.com"
    phases:
        - duration: 120        # segundos
            arrivalRate: 10      # usuarios por segundo
scenarios:
    - name: Flujo básico
        flow:
            - get:
                    url: "/status"
            - post:
                    url: "/login"
                    json:
                        user: "demo"
                        pass: "123456"
```

### Ejecución

```bash
artillery run test.yml
```

## Comandos principales

### Simulación rápida

Ejecuta una prueba simple sin archivo de configuración:

```bash
artillery quick --count 20 --num 10 https://api.ejemplo.com/status
```

(count = usuarios virtuales, num = peticiones por usuario)

### Pruebas detalladas

```bash
artillery run ruta/al/archivo.yml
```

### Generación de reporte HTML

```bash
artillery run test.yml --output reporte.json
artillery report reporte.json
```

## Métricas clave en los reportes

- Latencia (p50, p95, p99)
- Throughput (req/s)
- Tasa de errores
- Distribución de respuestas

## Ventajas de usar Artillery

- Simplicidad y flexibilidad.
- Escenarios complejos con múltiples flujos.
- Escalable (decenas a miles de usuarios).
- Métricas claras para análisis temprano.

## Buenas prácticas

- Probar entornos aislados (staging).
- Establecer objetivos (SLO/SLI) antes de ejecutar.
- Incluir pruebas en pipelines CI.
- Aumentar carga de forma gradual (ramp-up).

## Conclusión

Artillery facilita validar rendimiento y estabilidad de aplicaciones backend Node.js mediante simulaciones realistas, reportes detallados y configuraciones declarativas en YAML o JSON.
